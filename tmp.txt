        # Combined rotation matrix: R = Rz * Ry * Rx
        R_world_to_surf = Rz @ Ry @ Rx
        
        # Transform EE position from world frame to surface frame
        ee_pos_world = ca.vertcat(px_world, py_world, pz_world)
        surf_pos = ca.vertcat(self.surface_position[0], self.surface_position[1], self.surface_position[2])
        
        # Position in surface frame = R^T * (p_world - p_surface)
        ee_pos_surf = R_world_to_surf.T @ (ee_pos_world - surf_pos)

        
        # Extract surface frame coordinates
        px_surf = ee_pos_surf[0]  # x in surface frame
        py_surf = ee_pos_surf[1]  # y in surface frame
        pz_surf = ee_pos_surf[2]  # z in surface frame (perpendicular to surface)


        # self.ocp.cost.cost_model_expr = running_cost
        # self.ocp.cost.cost_model_expr_e = terminal_cost
        # running_cost = 
        # terminal_cost = w_position_xy * (x_ref - px_surf)**2 + w_position_z * (z_ref - pz_surf)**2
        # self.ocp.constraints.x0 = initial_state
